# Маркетинг
## Описание проекта
Интернет-магазин собирает историю покупателей, проводит рассылки предложений и
планирует будущие продажи. Для оптимизации процессов надо выделить пользователей,
которые готовы совершить покупку в ближайшее время.
## Цель
Предсказать вероятность покупки в течение 90 дней.
## Задачи
- Изучить данные;
- Разработать полезные признаки;
- Создать модель для классификации пользователей;
- Улучшить модель и максимизировать метрику roc_auc;
- Выполнить тестирование.
## Данные
**apparel-purchases** - история покупок:

- client_id идентификатор пользователя;
- quantity количество товаров в заказе;
- price цена товара;
- category_ids вложенные категории, к которым отнсится товар;
- date дата покупки;
- message_id идентификатор сообщения из рассылки.

**apparel-messages** - история рекламных рассылок:

- bulk_campaign_id идентификатор рекламной кампании;
- client_id идентификатор пользователя;
- message_id идентификатор сообщений;
- event тип действия;
- channel канал рассылки;
- date дата рассылки;
- created_at точное время создания сообщения.

**apparel-target_binary** - совершит ли клиент покупку в течение следующих 90 дней:

- client_id идентификатор пользователя;
- target целевой признак.

## Выводы

**Что было сделано в ходе проектной работы**:
1.	Загружены 3 датасета в 3 датафрейма.
2.	Датафреймы были проанализированы. Основные наблюдения.
- в столбце category_ids датафрейма **apparel-purchases**: значения выглядит как список, но на самом деле являются строкой. Значения были преобразованы в списки;
-  в датафрейме **apparel-purchases**: 73 тыс. дубликатов из 200 тыс. строк. Дубликаты были удалены;
- в датафрейме **apparel-purchases**: 48 тыс. дубликатов из 12 млн. строк. Дубликаты были удалены;
- в датафрейме**target** присутствует сильный дисбаланс классов.
3. Были созданы признаки на основе агрегации данных для каждого клиента:
- **level_0_unique, level_1_unique, level_2_unique, level_3_unique** - количество уникальных категорий (подкатегорий), которые с которыми взаимодействует клиент;
- **price_mean** - средняя цена товара;
-  **level_0_mode, level_1_mode** - любимая категория (подкатегория) на уровне 0 и 1;
- **month_quantity_mean, month_price_mean** - среднее количество товаров и среднюю цену за месяц;
- **quantity_by_message, price_by_message** - среднее количество товаров и среднюю цену за одну рекламную рассылку после которой клиент принял решение купить какой-либо товар;
- **activity** - активность клиента при взаимодействии с сообщениями;
- **pre_purchase_engagement** - среднее количество действий, которое совершает клиент после получения сообщения;
- **per_email, per_mobile_push** - доля использования mail или mobile_push;
- **steps_before_purchase, cost_of_step** - сколько шагов делает клиент при покупке и какая цена у шага;
- **message_to_purchase** - сколько в среднем времени (в секундах) проходит с момента получения сообщения до совершения покупки.
4. Все датаффреймы с агрегированными признаками были объединены с исходными датафреймами.
5. Построена матрица phik-корреляции и с помощью функции select_features отобраны признаки, которые коррелируют с целевой переменной и не сильно коррелируют друг с другом. Этими признаками оказались: **level_1_unique, activity, level_3_unique, pre_purchase_engagement, level_0_unique, level_1_mode, per_mobile_push, price_by_message, quantity_by_message**.
6. Созданы обучающая и тестовые выборки.
7. Были обучены 3 модели ML на основе следующих алгоритмов: логистическая регрессия, случайный лес и градиентный бустинг. Модели обучались с подбором гиперпараметров. Лучшей модель оказалась модель на основе алгоритма RandomForest с метрикой на трейне roc_auc=0.70 и следующими гиперпараметрами (max_depth = 5, min_samples_leaf = 1, n_estimators = 200).
8. Лучшая модель была испытана на тестовой выборке, но, к сожалению, показала плохие результаты (roc_auc=0.51), что свидетельствует о том, что она переобучилась.


